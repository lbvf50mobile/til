Ruby code:
```Ruby
# Leetcode: 467. Unique Substrings in Wraparound String.
# https://leetcode.com/problems/unique-substrings-in-wraparound-string/
# Runtime: 144 ms, faster than 50.00% of Ruby online submissions for Unique Substrings in Wraparound String.
# Memory Usage: 210.3 MB, less than 50.00% of Ruby online submissions for Unique Substrings in Wraparound String.
# Thanks God!
# @param {String} p
# @return {Integer}
def find_substring_in_wrapround_string(ps)
    len = 1
    h = {}
    (0...ps.size).each do |i|
        if i>0 && (ps[i-1].ord + 1 == ps[i].ord  || (ps[i-1] == ?z && ?a == ps[i]))
            len += 1
        else
            len = 1
        end
        h[ps[i]] ||= 0
        h[ps[i]] = len if len > h[ps[i]]
    end
    h.values.sum
end
```

