# Leetcode: 697.

```Ruby
# @param {Integer[]} nums
# @return {Integer}
def find_shortest_sub_array(nums)
    max_freq = 0
    h = {}
    h_pos = {}
    nums.each do |i|
        
        h[i] ||= 0
        h[i] += 1
        
        if h_pos[i].nil?
            x =  {first: i, last: i, size: 1}
            h_pos[i] = x
        else
            a =  h_pos[i][:first]
            b =  (i - h_pos[i][:first] + 1)
            x = {first: a , last: i, size: b }
            h_pos[i] = x
        end
        
        max_freq = h[i] if h[i] > max_freq
    end
    
    h.to_a
        .select{|(key,val)| val == max_freq}
        .map{|(key,val)| h_pos[key]}
end
```